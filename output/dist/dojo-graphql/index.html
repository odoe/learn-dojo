<!DOCTYPE html>
<html lang="en-us">
<head><base href="/">
  <title>learn dojo</title>
  <meta charset="utf-8">
	<meta name="theme-color" content="#009dff">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="learn dojo - byte by byte">
	<link rel="icon" href="/assets/favicon.ico" />
	<link rel="stylesheet" type="text/css" href="prism.1_inztFX.css" />
	<link rel="preconnect" href="https://www.google-analytics.com" />
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-56544808-7"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-56544808-7');
	</script>
<meta name="apple-mobile-web-app-title" content="learn-dojo" /><meta name="apple-mobile-web-app-capable" content="yes" /><meta name="apple-mobile-web-app-status-bar-style" content="default" /><meta name="theme-color" content="#009dff" /><link rel="apple-touch-icon" sizes="512x512" href="icon_512x512.ca45ef50142a78ad4bd2d28215f15034.png" /><link rel="apple-touch-icon" sizes="256x256" href="icon_256x256.7da342a93e078e9a7fef21fa5d9dbbaf.png" /><link rel="apple-touch-icon" sizes="128x128" href="icon_128x128.811bfb9a7c545c93ad37790968688f24.png" /><link rel="manifest" href="manifest.83b2d52a04a4315afec956b410eaacf0.json" /><script>
	if (!window['learn_dojo']) {
		window['learn_dojo'] = {}
	}
	window['learn_dojo'].base = '/'</script><script>
		if ('serviceWorker' in window.navigator) {
			window.addEventListener('load', function() {
				window.navigator.serviceWorker.register('service-worker.js');
			});
		}
	</script><meta name="mobile-web-app-capable" content="yes"><style>.Blog-m__root__5737d01B0aR{padding:1.2rem}@import url(https://fonts.googleapis.com/css?family=Montserrat&display=swap);html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{-webkit-box-sizing:content-box;box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{-webkit-box-sizing:border-box;box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.6666666666666667 Georgia,Cambria,serif;-webkit-box-sizing:border-box;box-sizing:border-box;overflow-y:scroll}*{-webkit-box-sizing:inherit;box-sizing:inherit}:before{-webkit-box-sizing:inherit;box-sizing:inherit}:after{-webkit-box-sizing:inherit;box-sizing:inherit}body{color:rgba(0,0,0,.87);font-family:Georgia,Cambria,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;padding:0;margin:0 0 1.66667rem}h1{font-size:2rem}h1,h2{padding:0;margin:0 0 1.66667rem;color:rgba(0,0,0,.5);font-family:Montserrat,sans-serif;font-weight:400;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.51572rem}h3{font-size:1.31951rem}h3,h4{padding:0;margin:0 0 1.66667rem;color:rgba(0,0,0,.5);font-family:Montserrat,sans-serif;font-weight:400;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.87055rem}h5,h6{padding:0;margin:0 0 1.66667rem;color:rgba(0,0,0,.5);font-family:Montserrat,sans-serif;font-weight:400;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.81225rem;font-style:italic}hgroup{padding:0;margin:0 0 1.66667rem}ul{list-style-position:outside;list-style-image:none;list-style:disc}ol,ul{padding:0;margin:0 0 1.66667rem 1.66667rem}ol{list-style-position:outside;list-style-image:none}dd,dl,figure,p{padding:0;margin:0 0 1.66667rem}pre{font-size:.85rem}pre,table{padding:0;margin:0 0 1.66667rem;line-height:1.66667rem}table{font-size:1rem;border-collapse:collapse;width:100%}fieldset{padding:0}blockquote,fieldset{margin:0 0 1.66667rem}blockquote{padding:.83333rem .83333rem .83333rem 1.45833rem;font-size:1.1487rem;line-height:1.66667rem;background:rgba(0,0,0,.03);color:rgba(0,0,0,.69);border-left:.20833rem solid rgba(0,0,0,.2)}form,iframe,noscript{padding:0;margin:0 0 1.66667rem}hr{padding:0;margin:0 0 calc(1.66667rem - 1px);background:rgba(0,0,0,.2);border:none;height:1px}address{padding:0;margin:0 0 1.66667rem}b,dt,strong,th{font-weight:700}li{margin-bottom:calc(1.66667rem / 2)}ol li,ul li{padding-left:0}li>ol{margin-left:1.66667rem;margin-bottom:calc(1.66667rem / 2);margin-top:calc(1.66667rem / 2)}li>ul{margin-left:1.66667rem;margin-bottom:calc(1.66667rem / 2);margin-top:calc(1.66667rem / 2)}blockquote :last-child{margin-bottom:0}li :last-child{margin-bottom:0}p :last-child{margin-bottom:0}li>p{margin-bottom:calc(1.66667rem / 2)}code,kbd,samp{font-size:.85rem;line-height:1.66667rem}abbr,acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help;text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.83333rem 1.11111rem calc(.83333rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}a{color:#07e;text-decoration:none}a:active,a:hover{color:#e32}blockquote>:last-child{margin-bottom:0}blockquote cite{font-size:1rem;line-height:1.66667rem;color:rgba(0,0,0,.87);font-weight:400}blockquote cite:before{content:"\2014   "}@media only screen and (max-width:480px){ol,ul{margin-left:1.66667rem}blockquote{margin-left:-1.25rem;margin-right:-1.25rem;padding-left:1.14583rem;padding-right:1.25rem}}h1,h2,h3,h4,h5,h6{margin-top:3.33333rem}body{margin:0;padding:0;color:rgba(46,46,46,.95)}header{font-family:Montserrat,sans-serif;font-weight:400;text-rendering:optimizeLegibility;line-height:1.1}article img{display:block;max-width:500px;margin:0 auto}code[class*=language-],pre[class*=language-]{font-size:14px}@media only screen and (max-width:480px){article img{display:block;max-width:300px;margin:0 auto}}.Footer-m__root__5737d01zPMX{-webkit-box-flex:1;-ms-flex:1;flex:1;text-align:center;padding:3rem 1rem;overflow:hidden}.Footer-m__details__5737d02pZwP{font-size:.75rem}.Footer-m__logo__5737d02kD38{max-height:48px}.Footer-m__link__5737d03-JoA,.Footer-m__link__5737d03-JoA:visited{color:#003866}.Header-m__root__5737d015XcQ{-webkit-box-flex:1;-ms-flex:1;flex:1;overflow:hidden;color:#fff;background-color:#333;padding:1rem}.Header-m__title__5737d03OSiY{font-size:20px;margin:0;font-weight:400}.Header-m__link__5737d02GEKH:hover{color:#fff;background-color:#333}.Header-m__link__5737d02GEKH{min-width:140px;text-align:center;text-decoration:none;padding:18px;color:#fff;-webkit-box-sizing:border-box;box-sizing:border-box}:root{--grid-base:8px}.Hero-m__root__5737d012HF4{width:100vw;height:300px;max-height:300px;display:-webkit-box;display:-ms-flexbox;display:flex;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;left:50%;right:50%;margin:0 -50vw 2rem}.Hero-m__image__5737d02nrHx{width:100vw;height:300px;-o-object-fit:cover;object-fit:cover}.Hero-m__description__5737d03I4v5{margin-left:calc(5 * 8px);margin-left:calc(5 * var(--grid-base));margin-top:calc(8px);margin-top:calc(var(--grid-base));position:absolute;font-size:.8rem;top:0;color:#fff}.SignUp-m__root__5737d01pvR6{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.SignUp-m__title__5737d02WSYN{margin-top:0}.SignUp-m__email__5737d020Zk1{margin:90px 0 40px;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,Oxygen,Fira Sans,Droid Sans,Helvetica Neue}.SignUp-m__form__5737d01C66N{background-color:#fff;border-radius:6px;-webkit-box-shadow:0 2px 15px 0 rgba(210,214,220,.5);box-shadow:0 2px 15px 0 rgba(210,214,220,.5);max-width:700px;overflow:hidden}.SignUp-m__gridcontainer__5737d01Rne0{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));width:100%}.SignUp-m__column__5737d01NIGa{padding:20px}.SignUp-m__info__5737d03AU2H{margin:15px 0;font-size:.7rem}.SignUp-m__input__5737d02oS1c{width:100%;border-radius:4px;color:#000;font-weight:400;background:#fff;font-size:15px;padding:12px;border:1px solid #e3e3e3;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;line-height:1.4;margin:5px;-webkit-transition:border-color .3s ease-out;transition:border-color .3s ease-out}.SignUp-m__link__5737d03d58p{color:#003866}.SignUp-m__submit__5737d02mNG6{color:#003866;text-decoration:none;background:#fff;padding:10px;border:2px solid #494949;display:inline-block;-webkit-transition:all .4s ease 0s;transition:all .4s ease 0s;cursor:pointer}.SignUp-m__submit__5737d02mNG6:hover{color:#fff;background:#003866;border-color:#003866;-webkit-transition:all .4s ease 0s;transition:all .4s ease 0s}.Layout-m__root__5737d03l2TO{-webkit-box-shadow:rgba(0,0,0,.1) 0 4px 120px;box-shadow:0 4px 120px rgba(0,0,0,.1);grid-column:1/6;padding:0;overflow:hidden}.Layout-m__section__5737d01sUgf{grid-column:2/auto;padding:0 9rem}@media only screen and (max-width:900px){.Layout-m__root__5737d03l2TO{grid-column:1/6;padding:0}.Layout-m__section__5737d01sUgf{grid-column:1/6;padding:0 2rem}}@media only screen and (max-width:480px){.Layout-m__root__5737d03l2TO,.Layout-m__section__5737d01sUgf{grid-column:1/6;padding:0}}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2b2b2b}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#d4d0ab}.token.punctuation{color:#fefefe}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#ffa07a}.token.boolean,.token.number{color:#00e0e0}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#abe338}.token.entity,.token.operator,.token.url,.token.variable{color:#00e0e0}.token.atrule,.token.attr-value,.token.function{color:gold}.token.keyword{color:#00e0e0}.token.important,.token.regex{color:gold}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{color:windowText;background:window}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token.atrule,.token.attr-value,.token.function,.token.keyword,.token.operator,.token.selector{font-weight:700}.token.attr-value,.token.comment,.token.doctype,.token.function,.token.keyword,.token.operator,.token.property,.token.string{color:highlight}.token.attr-value,.token.url{font-weight:400}}</style></head>
<body>
	<div id="root"><div class="Layout-m__root__5737d03l2TO"><header class="Header-m__root__5737d015XcQ"><div class="Header-m__title__5737d03OSiY"><a class="Header-m__link__5737d02GEKH" href="/">learn dojo</a></div></header><div class="Hero-m__root__5737d012HF4"><picture><source type="image/webp" srcset="
        /assets/images/learn-dojo-jumbotron-320.webp 320w,
        /assets/images/learn-dojo-jumbotron-640.webp 640w,
        /assets/images/learn-dojo-jumbotron-768.webp 768w,
        /assets/images/learn-dojo-jumbotron-1024.webp 1024w,
        /assets/images/learn-dojo-jumbotron-1366.webp 1366w,
        /assets/images/learn-dojo-jumbotron-1600.webp 1600w,
        /assets/images/learn-dojo-jumbotron-1920.webp 1920w
      "><source type="image/jpeg" srcset="
        /assets/images/learn-dojo-jumbotron-320.jpg 320w,
        /assets/images/learn-dojo-jumbotron-640.jpg 640w,
        /assets/images/learn-dojo-jumbotron-768.jpg 768w,
        /assets/images/learn-dojo-jumbotron-1024.jpg 1024w,
        /assets/images/learn-dojo-jumbotron-1366.jpg 1366w,
        /assets/images/learn-dojo-jumbotron-1600.jpg 1600w,
        /assets/images/learn-dojo-jumbotron-1920.jpg 1920w
      "><img alt="byte by byte" loading="lazy" class="Hero-m__image__5737d02nrHx" src="/assets/images/learn-dojo-jumbotron-768.jpg"></picture><h3 class="Hero-m__description__5737d03I4v5">byte by byte</h3></div><main class="Layout-m__section__5737d01sUgf"><div class="Blog-m__root__5737d01B0aR"><section><picture><source type="image/webp" srcset="/assets/blog/dojo-graphql.webp"><source type="image/jpeg" srcset="/assets/blog/dojo-graphql.jpg"><img src="/assets/blog/dojo-graphql.jpg" alt="Dojo GraphQL" loading="lazy"></picture><article class="Article-m__root__5737d01D5nz"><a aria-label="Dojo GraphQL" href="dojo-graphql"><h2>Dojo GraphQL</h2></a><p>Rene Rubalcava | June 16, 2019</p><div><p><a href="https://graphql.org/" target="_blank" rel="nofollow">GraphQL</a> has grown in popularity over the past couple of years. Where GraphQL shines is in its descriptive nature of querying data.</p>
<p>If you want to write a query for the <a href="https://swapi.co/" target="_blank" rel="nofollow">Star Wars API</a> to get all the film titles, it might look something like this.</p>
<pre><code>{
  allFilms{
    edges{
      node{
        title
      }
    }
  }
}
</code></pre>
<p>The query is <em>JSON-like</em>, but it's not JSON. You can learn more about GraphQL on the <a href="https://www.graphql.com/tutorials/" target="_blank" rel="nofollow">tutorials page</a>.</p>
<p><a href="https://github.com/apollographql/apollo-client" target="_blank" rel="nofollow">Apollo</a> provides a client API you can use to work with GraphQL. It saves you some work of writing your own POST requests, so I highly recommend you learn it. Apollo provides libraries to integrate with Angular and React, but so far not one for Dojo. But that's ok, because you can use the Apollo Client to build your own GraphQL integration.</p>
<p>Looking at <a href="https://github.com/apollographql/react-apollo" target="_blank" rel="nofollow">react-apollo</a>, they have an <code>ApolloProvider</code> that you can use to wrap components of your application. This provides the Apollo client to components. Those components can then use a <code>Query</code> higher order component to pass the query and client and thus display the result.</p>
<p><em>How hard can that be?</em></p>
<h2 id="trust-the-process">Trust the Process</h2>
<p>When working with Dojo, most of your work with external APIs is probably going to be done in a <a href="https://github.com/dojo/framework/tree/master/src/stores#processes" target="_blank" rel="nofollow">process</a>. We covered this topic in detail in <a href="https://learn-dojo.com/maintain-state-with-dojo-stores" target="_blank" rel="nofollow">this post</a>.</p>
<p>Here is what a generic process for working with GraphQL might look like.</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">// src/processes/apolloProcess.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  createProcess<span class="token punctuation">,</span>
  createCommandFactory
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/stores/process"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/stores/state/operations"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> commandFactory <span class="token operator">=</span> createCommandFactory<span class="token operator">&lt;</span><span class="token punctuation">{</span>
  client<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span> <span class="token comment">// this will be the apollo client</span>
  data<span class="token punctuation">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span> <span class="token comment">// this will be graphql result</span>
  loaded<span class="token punctuation">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// keep track if the data has been loaded yet</span>
<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fetchData <span class="token operator">=</span> <span class="token function">commandFactory</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> path<span class="token punctuation">,</span> payload <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> client<span class="token punctuation">,</span> query <span class="token punctuation">}</span> <span class="token operator">=</span> payload<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> client<span class="token punctuation">.</span><span class="token method function property-access">query</span><span class="token punctuation">(</span><span class="token punctuation">{</span> query <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"loaded"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> fetchDataProcess <span class="token operator">=</span> <span class="token function">createProcess</span><span class="token punctuation">(</span><span class="token string">"fetch-data"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>fetchData<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>This process will take a given apollo client instance and a GraphQl query to fetch some results. This works pretty well because it's not tied to any particular endpoint or data structure, even though it is currently typed as <code>any</code> for client and data. I could try to work around that with some generics, but wanted to keep this example fairly simple.</p>
<h2 id="put-it-in-a-box">Put it in a box</h2>
<p>We can tie this together with a widget and <a href="https://dojo.io/tutorials/1010_containers_and_injecting_state/" target="_blank" rel="nofollow">Dojo container</a>.</p>
<pre class="language-tsx"><code class="language-tsx"><span class="token comment">// src/containers/QueryContainer.tsx</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> tsx <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/widget-core/tsx"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">WidgetBase</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/widget-core/WidgetBase"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">Store</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/stores/Store"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">StoreContainer</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/stores/StoreInjector"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchDataProcess <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../processes/apolloProcess"</span><span class="token punctuation">;</span>

<span class="token comment">// Use the ApolloClient for typing</span>
<span class="token keyword">import</span> <span class="token maybe-class-name">ApolloClient</span> <span class="token keyword">from</span> <span class="token string">"apollo-boost"</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">QueryProps</span> <span class="token punctuation">{</span>
  client<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token maybe-class-name">ApolloClient</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>any</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">;
  query: string;
  data?: any;
  loaded?: boolean;
  fetchData?: (args: any) =&gt; void;
}

// base widget that handles displaying children that use the Query
export class BaseQuery extends WidgetBase&lt;QueryProps, any&gt; </span><span class="token punctuation">{</span>
  <span class="token function">onAttach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> client<span class="token punctuation">,</span> query<span class="token punctuation">,</span> loaded<span class="token punctuation">,</span> fetchData <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">;</span>
    <span class="token comment">// if the data has not been loaded yet</span>
    <span class="token comment">// and we have a query, lets get some data</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>loaded <span class="token operator">&amp;&amp;</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> client<span class="token punctuation">,</span> query <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> loaded<span class="token punctuation">,</span> data <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// if the child nodes are a function,</span>
      <span class="token comment">// call the function with data from the</span>
      <span class="token comment">// GraphQL process</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">child</span><span class="token punctuation">(</span><span class="token punctuation">{</span> loading<span class="token punctuation">:</span> <span class="token operator">!</span>loaded<span class="token punctuation">,</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// or just return a regular node</span>
      <span class="token keyword">return</span> child<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token plain-text">

function getProperties(store: Store&lt;{ data: any; loaded: boolean }&gt;): any </span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">,</span> path <span class="token punctuation">}</span> <span class="token operator">=</span> store<span class="token punctuation">;</span>

  <span class="token comment">// pass the Dojo store properties and methods to the widget</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    loaded<span class="token punctuation">:</span> <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"loaded"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    fetchData<span class="token punctuation">:</span> <span class="token function">fetchDataProcess</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token plain-text">
// Use a StoreContainer
export const Query = StoreContainer(BaseQuery, "state", </span><span class="token punctuation">{</span>
  getProperties
<span class="token punctuation">}</span><span class="token plain-text">);
</span></code></pre>
<p>In this snippet we provide a <code>BaseQuery</code> that is going to handle taking any queries that child widgets might provide and use those queries to to fetch some data. This widget uses a <code>StoreContainer</code> to pass the store that is updated using our process to the <code>BaseQuery</code>. We can call this container a <code>Query</code> to keep it simple. This is going to allow us to write some code like the following.</p>
<pre class="language-tsx"><code class="language-tsx"><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyWidget</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetBase</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> client<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> client <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token comment">// use our Query Widget with the client it's given and</span>
      <span class="token comment">// a query we have written</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Query</span></span> <span class="token attr-name">query</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>query<span class="token punctuation">}</span></span> <span class="token attr-name">client</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>client<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loading<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">classes</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>css<span class="token punctuation">.</span><span class="token property-access">root</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token function">parseMyData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Query</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="be-a-good-provider">Be a good provider</h2>
<p>At this point you might be asking yourself, <em>How do I pass a client to a widget that uses this?</em></p>
<p>Good question. Technically, you could create the client in your Widget module and provide it to <code>&lt;Query&gt;</code>. But that seems kind of icky to bind backend concerns into my UI code. The way <code>react-apollo</code> does this is by providing an <code>&lt;ApolloProvider&gt;</code> that you can give a <code>client</code> and then wrap your application components with it. These components will have access to the Apollo <code>client</code> to give to the <code>Query</code> higher order component.</p>
<p>It basically looks like the <code>&lt;ApolloProvider&gt;</code> <em>provides</em> its <code>client</code> property to child widgets. <em>I can do that</em>.</p>
<pre class="language-tsx"><code class="language-tsx"><span class="token comment">// src/providers/ApolloProvider.tsx</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> tsx <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/widget-core/tsx"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">WidgetBase</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/widget-core/WidgetBase"</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ApolloProvider</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetBase</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> client<span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> client <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> child <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>child <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// inject the client of the provider into each child</span>
        <span class="token comment">// widget</span>
        <span class="token punctuation">(</span>child <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">.</span><span class="token property-access">client</span> <span class="token operator">=</span> client<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>What this <em>naive</em> <code>ApolloProvider</code> does is iterates over the <code>children</code> of the widget and injects the <code>client</code> property into each one. I'm sure the <code>react-apollo</code> implementation does much more, but I'm not going to argue with what works.</p>
<p>Now that I have my provider, I can start to tie it all together.</p>
<h2 id="the-great-provider">The great provider</h2>
<p>In my <code>main.tsx</code> where I initialize my Dojo application, I can create my <code>ApolloClient</code> and pass it my <code>ApolloProvider</code> that will wrap my other widgets so that I can use it.</p>
<pre class="language-tsx"><code class="language-tsx"><span class="token comment">// src/main.tsx</span>
<span class="token spread operator">...</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">Store</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/stores/Store"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> registerStoreInjector <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/stores/StoreInjector"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token maybe-class-name">ApolloClient</span> <span class="token keyword">from</span> <span class="token string">"apollo-boost"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">ApolloProvider</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./providers/ApolloProvider"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">Countries</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./widgets/Countries"</span><span class="token punctuation">;</span>

<span class="token comment">// initialize a GraphQL client</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ApolloClient</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  uri<span class="token punctuation">:</span> <span class="token string">"https://countries.trevorblades.com"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Store</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> registry <span class="token operator">=</span> <span class="token function">registerStoreInjector</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetBase</span> <span class="token punctuation">{</span>
  <span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// pass the client to the ApolloProvider</span>
    <span class="token comment">// The &lt;Countries /&gt; widget will use it</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ApolloProvider</span></span> <span class="token attr-name">client</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>client<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token string">"\u2728 dojo-apollo \u2728"</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Countries</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ApolloProvider</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token spread operator">...</span>
</code></pre>
<p>The sample GraphQL API I am going to use provides a list of Countries. So I'm going to write a widget that can display those results.</p>
<h2 id="graphql-results">GraphQL results</h2>
<p>Here is where we get to see the fruit of our labors! We can write a widget that will display a specific set of data from our GraphQL API. So the widget can provide its own GraphQL query. This makes sense when you think of the widget as <em>owning</em> this query.</p>
<pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> <span class="token punctuation">{</span> tsx <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/widget-core/tsx"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">WidgetBase</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dojo/framework/widget-core/WidgetBase"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> gql <span class="token keyword">from</span> <span class="token string">"graphql-tag"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> css <span class="token keyword">from</span> <span class="token string">"./styles/Countries.m.css"</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token maybe-class-name">Query</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../containers/QueryContainer"</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">Country</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  code<span class="token punctuation">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// initialize a GraphQL query</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> query <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token graphql language-graphql">
  <span class="token punctuation">{</span>
    countries <span class="token punctuation">{</span>
      name
      code
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

<span class="token comment">// helper method to display each country as a list item</span>
<span class="token comment">// each country will link to a wikipedia page</span>
<span class="token keyword">const</span> <span class="token function-variable function">countryItems</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">countries<span class="token punctuation">:</span> <span class="token maybe-class-name">Country</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span>
  countries<span class="token punctuation">.</span><span class="token method function property-access">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> code <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">classes</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>css<span class="token punctuation">.</span><span class="token property-access">item</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>code<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>
        <span class="token attr-name">classes</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>css<span class="token punctuation">.</span><span class="token property-access">link</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>
        <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>code<span class="token punctuation">}</span></span>
        <span class="token attr-name">href</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://en.wikipedia.org/wiki/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">}</span></span>
        <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span>
      <span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Countries</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetBase</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> client<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token builtin">any</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">protected</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this is the `client` that was injected by the `&lt;ApolloProvider&gt;`</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> client <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">properties</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Query</span></span> <span class="token attr-name">query</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>query<span class="token punctuation">}</span></span> <span class="token attr-name">client</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>client<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> loading<span class="token punctuation">,</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// if data is still loading, show a message</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>loading<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// when data is done loading, display the list</span>
            <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">classes</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">[</span>css<span class="token punctuation">.</span><span class="token property-access">root</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token function">countryItems</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token property-access">countries</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Query</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>This widget uses our <code>Query</code> container to wrap up the part of the widget that relies on the GraphQL results. This looks pretty much exactly like <code>react-apollo</code>.</p>
<p>You can see this entire example in action in this <a href="https://codesandbox.io/s/dojo-graphql-zgmi6?fontsize=14" target="_blank" rel="nofollow">code sandbox</a>.</p>
<h2 id="summary">Summary</h2>
<p>This is a fairly simple implementation of a GraphQL <code>&lt;Query&gt;</code> and <code>&lt;ApolloProvider&gt;</code>, but it works pretty well in a case like this. If you have multiple different queries you want to run in a single application, I think you would need to create a factory method for your containers to define multiple states that would contain different results.</p>
<p>This is definitely something I want to continue working on in the future and I think there might be some more <em>Dojo way</em> of handling this in some features that look to be coming to Dojo in the future.</p>
<p>As always, have fun with it and keep on hacking!</p></div></article></section></div></main><aside class="SignUp-m__root__5737d01pvR6"><div class="SignUp-m__email__5737d020Zk1"><form class="SignUp-m__form__5737d01C66N" action="https://odoe.us9.list-manage.com/subscribe/post?u=711bff655927baa32886103d5&amp;id=6d978f8bcf" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank"><div class="SignUp-m__gridcontainer__5737d01Rne0"><div class="SignUp-m__column__5737d01NIGa"><h3 class="SignUp-m__title__5737d02WSYN"><strong>Subscribe to newsletter</strong></h3><div><label for="mce-EMAIL">Your email</label><input placeholder="Your email" type="email" name="EMAIL" class="SignUp-m__input__5737d02oS1c" id="mce-EMAIL"></div><div><label for="mce-FNAME">Your first name</label><input placeholder="Your first name" type="text" name="FNAME" class="SignUp-m__input__5737d02oS1c" id="mce-FNAME"></div><button class="SignUp-m__submit__5737d02mNG6" type="submit">Subscribe</button><div class="SignUp-m__info__5737d03AU2H"><p>We use Mailchimp as our marketing platform. By clicking below to subscribe, you acknowledge that your information will be transferred to Mailchimp for processing. <a class="SignUp-m__link__5737d03d58p" href="https://mailchimp.com/legal/" rel="noopener noreferrer" target="_blank" aria-label="Learn more about Mailchimp's privacy practices here">Learn more about Mailchimp's privacy practices here.</a></p></div></div></div></form></div></aside><footer class="Footer-m__root__5737d01zPMX"><span> 2020, odoenet</span><br><div><a class="Footer-m__link__5737d03-JoA" href="https://learn-dojo.com/atom.xml" rel="noopener noreferrer" target="_blank" aria-label="rss feed"><picture><source type="image/webp" srcset="/assets/images/logos/rss-logo-32px.webp"><source type="image/jpeg" srcset="/assets/images/logos/rss-logo-32px.png"><img alt="rss feed" loading="lazy" class="Footer-m__logo__5737d02kD38" src="/assets/images/logos/rss-logo-32px.png"></picture></a><a class="Footer-m__link__5737d03-JoA" href="https://github.com/odoe/learn-dojo" rel="noopener noreferrer" target="_blank" aria-label="github"><picture><source type="image/webp" srcset="/assets/images/logos/GitHub-Mark-32px.webp"><source type="image/jpeg" srcset="/assets/images/logos/GitHub-Mark-32px.png"><img alt="github" loading="lazy" class="Footer-m__logo__5737d02kD38" src="/assets/images/logos/GitHub-Mark-32px.png"></picture></a><a class="Footer-m__link__5737d03-JoA" href="https://www.youtube.com/channel/UCTMyJW_31j2hyZGKJpddgaQ" rel="noopener noreferrer" target="_blank" aria-label="youtube"><picture><source type="image/webp" srcset="/assets/images/logos/yt_logo_mono_light_32px.webp"><source type="image/jpeg" srcset="/assets/images/logos/yt_logo_mono_light_32px.png"><img alt="youtube" loading="lazy" class="Footer-m__logo__5737d02kD38" src="/assets/images/logos/yt_logo_mono_light_32px.png"></picture></a><a class="Footer-m__link__5737d03-JoA" href="https://dojo.io/" rel="noopener noreferrer" target="_blank" aria-label="powered by @dojo"><br>powered by @dojo</a></div><br><span class="Footer-m__details__5737d02pZwP">Last build: 4/20/2020</span><br></footer></div></div>
</body>
</html>
